# apig: Golang RESTful API Server Generator

apig is an RESTful API server generator.

Input: model definition based on [gorm](https://github.com/jinzhu/gorm) annotated struct
Output: restful json api server including tests and documents

## How to build and install

```bash
$ make
$ make install
```

`make` generates binary into `bin/apig`.

## How to use

### 1. Generate boilerplate

First, creating by `apig new` command.

```
apig new apig-sample -u wantedly -v gihub.com
```

generates golang api server boilerplate under `$GOPATH/src/gihhub.com/wantedly/apig-sample`.
You can omit `-u` and `-v` options. The default of `-u` is github username, and `-v` is `github.com`

### 2. Write model code

Second, write model definitions under models/. For example, user and email model is like below:

```
// models/user.go
package models

import "time"

type User struct {
	ID        uint       `gorm:"primary_key;AUTO_INCREMENT" json:"id"`
	Name      string     `gorm:"unique" json:"name,omitempty"`
	Emails    []Email    `gorm:"unique" json:"emails"`
	CreatedAt *time.Time `json:"created_at"`
	UpdatedAt *time.Time `json:"updated_at"`
}
```

```
// models/email.go
package models

type Email struct {
	ID      uint   `gorm:"primary_key;AUTO_INCREMENT" json:"id"`
	UserID  uint   `json:"user_id"`
	Address string `gorm:"unique" json:"address"`
	User    *User  `json:"user,omitempty"`
}
```

This models are based on [gorm](https://github.com/jinzhu/gorm) structure.
Please refer [gorm document](http://jinzhu.me/gorm/) to write detailed models.

### 3. Generate controllers, tests, documents etc. based on models.

Third, run the command:

```
apig gen
```

It creates all necessary codes to provide RESTful endpoints of models.

### 4. Build and run server

Finally, just build as normal go code.

```bash
$ go build -o bin/server
$ bin/server
```

The server runs at http://localhost:8080


## Usage

### `new` command
`new` command tells apig to generate API server skeleton.

```
$ apig new NAME
```

### `gen` command
`gen` command tells apig to generate files (routes, controllers, documents...) from [gorm](https://github.com/jinzhu/gorm) model files you wrote.

You MUST run this command at the directory which was generated by `new` command.

```
$ apig gen
```


## Development

Go 1.5 or higher is required.
If you're using Go 1.5, `GO15VENDOREXPERIMENT=1` must be set.


## LICENSE
[![MIT License](http://img.shields.io/badge/license-MIT-blue.svg?style=flat)](LICENSE)
